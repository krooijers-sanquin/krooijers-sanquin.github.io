import{R as Ie,m as S,r as de,H as Te,i as Be,f as Se,g as Pe,h as A,F as me}from"./utils.AjeXWoOT.js";import{A as g,I as G,a as Y,b as V,N as w,F as W,E as J,c as X,d as Le,r as ge,i as Z,e as R,f as Re,D as Me,_ as ze,g as He,h as ue}from"./astro/assets-service.DeftQf-f.js";import"./index.Czo94tge.js";function $e(t){return!(t.length!==3||!t[0]||typeof t[0]!="object")}function ke(t,e,a){const n=e?.split("/").pop()?.replace(".astro","")??"",s=(...r)=>{if(!$e(r))throw new g({...G,message:G.message(n)});return t(...r)};return Object.defineProperty(s,"name",{value:n,writable:!1}),s.isAstroComponentFactory=!0,s.moduleId=e,s.propagation=a,s}function Ne(t){return ke(t.factory,t.moduleId,t.propagation)}function ye(t,e,a){return typeof t=="function"?ke(t,e,a):Ne(t)}const Oe="4.16.3";function qe(){return e=>{if(typeof e=="string")throw new g({...Y,message:Y.message(JSON.stringify(e))});let a=[...Object.values(e)];if(a.length===0)throw new g({...V,message:V.message(JSON.stringify(e))});return Promise.all(a.map(n=>n()))}}function fe(t){return{site:new URL(t),generator:`Astro v${Oe}`,glob:qe()}}function xe(t){return!!t&&typeof t=="object"&&"then"in t&&typeof t.then=="function"}const Fe="astro:jsx",K=Symbol("empty"),Q=t=>t;function P(t){return t&&typeof t=="object"&&t[Fe]}function Ue(t){if(typeof t.type=="string")return t;const e={};if(P(t.props.children)){const a=t.props.children;if(!P(a)||!("slot"in a.props))return;const n=Q(a.props.slot);e[n]=[a],e[n].$$slot=!0,delete a.props.slot,delete t.props.children}else Array.isArray(t.props.children)&&(t.props.children=t.props.children.map(a=>{if(!P(a)||!("slot"in a.props))return a;const n=Q(a.props.slot);return Array.isArray(e[n])?e[n].push(a):(e[n]=[a],e[n].$$slot=!0),delete a.props.slot,K}).filter(a=>a!==K));Object.assign(t.props,e)}function be(t){return typeof t=="string"?S(t):Array.isArray(t)?t.map(e=>be(e)):t}function Ge(t){if("set:html"in t.props||"set:text"in t.props){if("set:html"in t.props){const e=be(t.props["set:html"]);delete t.props["set:html"],Object.assign(t.props,{children:e});return}if("set:text"in t.props){const e=t.props["set:text"];delete t.props["set:text"],Object.assign(t.props,{children:e});return}}}function i(t,e){const a={[Ie]:"astro:jsx",[Fe]:!0,type:t,props:e??{}};return Ge(a),Ue(a),a}const Ye=Symbol.for("astro:render");function Ve(t){return Object.defineProperty(t,Ye,{value:!0})}function we(){return Ve({type:"maybe-head"})}const ve=Symbol.for("astro.renderTemplateResult");class We{[ve]=!0;htmlParts;expressions;error;constructor(e,a){this.htmlParts=e,this.error=void 0,this.expressions=a.map(n=>xe(n)?Promise.resolve(n).catch(s=>{if(!this.error)throw this.error=s,s}):n)}async render(e){const a=this.expressions.map(n=>de(s=>{if(n||n===0)return _(s,n)}));for(let n=0;n<this.htmlParts.length;n++){const s=this.htmlParts[n],r=a[n];e.write(S(s)),r&&await r.renderToFinalDestination(e)}}}function Je(t){return typeof t=="object"&&!!t[ve]}function M(t,...e){return new We(t,e)}const ee=Symbol.for("astro:slot-string");class Xe extends Te{instructions;[ee];constructor(e,a){super(e),this.instructions=a,this[ee]=!0}}async function _(t,e){if(xe(e)&&(e=await e),e instanceof Xe)t.write(e);else if(Be(e))t.write(e);else if(Array.isArray(e)){const a=e.map(n=>de(s=>_(s,n)));for(const n of a)n&&await n.renderToFinalDestination(t)}else if(typeof e=="function")await _(t,e());else if(typeof e=="string")t.write(S(Se(e)));else if(!(!e&&e!==0))if(Pe(e))await e.render(t);else if(Je(e))await e.render(t);else if(Ke(e))await e.render(t);else if(ArrayBuffer.isView(e))t.write(e);else if(typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e))for await(const a of e)await _(t,a);else t.write(e)}const Ze=Symbol.for("astro.componentInstance");function Ke(t){return typeof t=="object"&&!!t[Ze]}function v(t={},e,{class:a}={}){let n="";a&&(typeof t.class<"u"?t.class+=` ${a}`:typeof t["class:list"]<"u"?t["class:list"]=[t["class:list"],a]:t.class=a);for(const[s,r]of Object.entries(t))n+=A(r,s,!0);return S(n)}function Qe(t){return t.fsPath&&!("fsPath"in t)}const ei=new TextDecoder,p=(t,e=0,a=t.length)=>ei.decode(t.slice(e,a)),E=(t,e=0,a=t.length)=>t.slice(e,a).reduce((n,s)=>n+("0"+s.toString(16)).slice(-2),""),ie=(t,e=0)=>{const a=t[e]+t[e+1]*256;return a|(a&2**15)*131070},I=(t,e=0)=>t[e]*2**8+t[e+1],d=(t,e=0)=>t[e]+t[e+1]*2**8,te=(t,e=0)=>t[e]+t[e+1]*2**8+t[e+2]*2**16,ii=(t,e=0)=>t[e]+t[e+1]*2**8+t[e+2]*2**16+(t[e+3]<<24),c=(t,e=0)=>t[e]*2**24+t[e+1]*2**16+t[e+2]*2**8+t[e+3],F=(t,e=0)=>t[e]+t[e+1]*2**8+t[e+2]*2**16+t[e+3]*2**24,ti={readUInt16BE:I,readUInt16LE:d,readUInt32BE:c,readUInt32LE:F};function u(t,e,a,n){a=a||0;const s=n?"BE":"LE",r="readUInt"+e+s;return ti[r](t,a)}function ai(t,e){if(t.length-e<4)return;const a=c(t,e);if(!(t.length-e<a))return{name:p(t,4+e,8+e),offset:e,size:a}}function x(t,e,a){for(;a<t.length;){const n=ai(t,a);if(!n)break;if(n.name===e)return n;a+=n.size}}const ni={validate:t=>p(t,0,2)==="BM",calculate:t=>({height:Math.abs(ii(t,22)),width:F(t,18)})},si=1,ri=6,li=16;function ae(t,e){const a=t[e];return a===0?256:a}function ne(t,e){const a=ri+e*li;return{height:ae(t,a+1),width:ae(t,a)}}const Ee={validate(t){const e=d(t,0),a=d(t,4);return e!==0||a===0?!1:d(t,2)===si},calculate(t){const e=d(t,4),a=ne(t,0);if(e===1)return a;const n=[a];for(let s=1;s<e;s+=1)n.push(ne(t,s));return{height:a.height,images:n,width:a.width}}},oi=2,pi={validate(t){const e=d(t,0),a=d(t,4);return e!==0||a===0?!1:d(t,2)===oi},calculate:t=>Ee.calculate(t)},ci={validate:t=>F(t,0)===542327876,calculate:t=>({height:F(t,12),width:F(t,16)})},hi=/^GIF8[79]a/,di={validate:t=>hi.test(p(t,0,6)),calculate:t=>({height:d(t,8),width:d(t,6)})},Ae={avif:"avif",mif1:"heif",msf1:"heif",heic:"heic",heix:"heic",hevc:"heic",hevx:"heic"};function mi(t,e,a){let n={};for(let s=e;s<=a;s+=4){const r=p(t,s,s+4);r in Ae&&(n[r]=1)}if("avif"in n)return"avif";if("heic"in n||"heix"in n||"hevc"in n||"hevx"in n)return"heic";if("mif1"in n||"msf1"in n)return"heif"}const gi={validate(t){const e=p(t,4,8),a=p(t,8,12);return e==="ftyp"&&a in Ae},calculate(t){const e=x(t,"meta",0),a=e&&x(t,"iprp",e.offset+12),n=a&&x(t,"ipco",a.offset+8),s=n&&x(t,"ispe",n.offset+8);if(s)return{height:c(t,s.offset+16),width:c(t,s.offset+12),type:mi(t,8,e.offset)};throw new TypeError("Invalid HEIF, no size found")}},ui=8,ki=4,yi=4,fi={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function se(t,e){const a=e+yi;return[p(t,e,a),c(t,a)]}function re(t){const e=fi[t];return{width:e,height:e,type:t}}const xi={validate:t=>p(t,0,4)==="icns",calculate(t){const e=t.length,a=c(t,ki);let n=ui,s=se(t,n),r=re(s[0]);if(n+=s[1],n===a)return r;const o={height:r.height,images:[r],width:r.width};for(;n<a&&n<e;)s=se(t,n),r=re(s[0]),n+=s[1],o.images.push(r);return o}},Fi={validate:t=>E(t,0,4)==="ff4fff51",calculate:t=>({height:c(t,12),width:c(t,8)})},bi={validate(t){if(c(t,4)!==1783636e3||c(t,0)<1)return!1;const e=x(t,"ftyp",0);return e?c(t,e.offset+4)===1718909296:!1},calculate(t){const e=x(t,"jp2h",0),a=e&&x(t,"ihdr",e.offset+8);if(a)return{height:c(t,a.offset+8),width:c(t,a.offset+12)};throw new TypeError("Unsupported JPEG 2000 format")}},wi="45786966",vi=2,z=6,Ei=2,Ai="4d4d",Ci="4949",le=12,Di=2;function _i(t){return E(t,2,6)===wi}function ji(t,e){return{height:I(t,e),width:I(t,e+2)}}function Ii(t,e){const n=z+8,s=u(t,16,n,e);for(let r=0;r<s;r++){const o=n+Di+r*le,m=o+le;if(o>t.length)return;const h=t.slice(o,m);if(u(h,16,0,e)===274)return u(h,16,2,e)!==3||u(h,32,4,e)!==1?void 0:u(h,16,8,e)}}function Ti(t,e){const a=t.slice(vi,e),n=E(a,z,z+Ei),s=n===Ai;if(s||n===Ci)return Ii(a,s)}function Bi(t,e){if(e>t.length)throw new TypeError("Corrupt JPG, exceeded buffer limits")}const Si={validate:t=>E(t,0,2)==="ffd8",calculate(t){t=t.slice(4);let e,a;for(;t.length;){const n=I(t,0);if(t[n]!==255){t=t.slice(1);continue}if(_i(t)&&(e=Ti(t,n)),Bi(t,n),a=t[n+1],a===192||a===193||a===194){const s=ji(t,n+5);return e?{height:s.height,orientation:e,width:s.width}:s}t=t.slice(n+2)}throw new TypeError("Invalid JPG, no size found")}},Pi={validate:t=>{const e=p(t,1,7);return["KTX 11","KTX 20"].includes(e)},calculate:t=>{const e=t[5]===49?"ktx":"ktx2",a=e==="ktx"?36:20;return{height:F(t,a+4),width:F(t,a),type:e}}},Li=`PNG\r

`,Ri="IHDR",oe="CgBI",Mi={validate(t){if(Li===p(t,1,8)){let e=p(t,12,16);if(e===oe&&(e=p(t,28,32)),e!==Ri)throw new TypeError("Invalid PNG");return!0}return!1},calculate(t){return p(t,12,16)===oe?{height:c(t,36),width:c(t,32)}:{height:c(t,20),width:c(t,16)}}},pe={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},ce={default:t=>{let e=[];for(;t.length>0;){const a=t.shift();if(a[0]!=="#"){e=a.split(" ");break}}if(e.length===2)return{height:parseInt(e[1],10),width:parseInt(e[0],10)};throw new TypeError("Invalid PNM")},pam:t=>{const e={};for(;t.length>0;){const a=t.shift();if(a.length>16||a.charCodeAt(0)>128)continue;const[n,s]=a.split(" ");if(n&&s&&(e[n.toLowerCase()]=parseInt(s,10)),e.height&&e.width)break}if(e.height&&e.width)return{height:e.height,width:e.width};throw new TypeError("Invalid PAM")}},zi={validate:t=>p(t,0,2)in pe,calculate(t){const e=p(t,0,2),a=pe[e],n=p(t,3).split(/[\r\n]+/);return(ce[a]||ce.default)(n)}},Hi={validate:t=>p(t,0,4)==="8BPS",calculate:t=>({height:c(t,14),width:c(t,18)})},Ce=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,j={height:/\sheight=(['"])([^%]+?)\1/,root:Ce,viewbox:/\sviewBox=(['"])(.+?)\1/i,width:/\swidth=(['"])([^%]+?)\1/},L=2.54,De={in:96,cm:96/L,em:16,ex:8,m:96/L*100,mm:96/L/10,pc:96/72/12,pt:96/72,px:1},$i=new RegExp(`^([0-9.]+(?:e\\d+)?)(${Object.keys(De).join("|")})?$`);function T(t){const e=$i.exec(t);if(e)return Math.round(Number(e[1])*(De[e[2]]||1))}function Ni(t){const e=t.split(" ");return{height:T(e[3]),width:T(e[2])}}function Oi(t){const e=j.width.exec(t),a=j.height.exec(t),n=j.viewbox.exec(t);return{height:a&&T(a[2]),viewbox:n&&Ni(n[2]),width:e&&T(e[2])}}function qi(t){return{height:t.height,width:t.width}}function Ui(t,e){const a=e.width/e.height;return t.width?{height:Math.floor(t.width/a),width:t.width}:t.height?{height:t.height,width:Math.floor(t.height*a)}:{height:e.height,width:e.width}}const Gi={validate:t=>Ce.test(p(t,0,1e3)),calculate(t){const e=j.root.exec(p(t));if(e){const a=Oi(e[0]);if(a.width&&a.height)return qi(a);if(a.viewbox)return Ui(a,a.viewbox)}throw new TypeError("Invalid SVG")}},Yi={validate(t){return d(t,0)===0&&d(t,4)===0},calculate(t){return{height:d(t,14),width:d(t,12)}}};function Vi(t,e){const a=u(t,32,4,e);return t.slice(a+2)}function Wi(t,e){const a=u(t,16,8,e);return(u(t,16,10,e)<<16)+a}function Ji(t){if(t.length>24)return t.slice(12)}function Xi(t,e){const a={};let n=t;for(;n&&n.length;){const s=u(n,16,0,e),r=u(n,16,2,e),o=u(n,32,4,e);if(s===0)break;o===1&&(r===3||r===4)&&(a[s]=Wi(n,e)),n=Ji(n)}return a}function Zi(t){const e=p(t,0,2);if(e==="II")return"LE";if(e==="MM")return"BE"}const Ki=["49492a00","4d4d002a"],Qi={validate:t=>Ki.includes(E(t,0,4)),calculate(t){const e=Zi(t)==="BE",a=Vi(t,e),n=Xi(a,e),s=n[256],r=n[257];if(!s||!r)throw new TypeError("Invalid Tiff. Missing tags");return{height:r,width:s}}};function et(t){return{height:1+te(t,7),width:1+te(t,4)}}function it(t){return{height:1+((t[4]&15)<<10|t[3]<<2|(t[2]&192)>>6),width:1+((t[2]&63)<<8|t[1])}}function tt(t){return{height:ie(t,8)&16383,width:ie(t,6)&16383}}const at={validate(t){const e=p(t,0,4)==="RIFF",a=p(t,8,12)==="WEBP",n=p(t,12,15)==="VP8";return e&&a&&n},calculate(t){const e=p(t,12,16);if(t=t.slice(20,30),e==="VP8X"){const n=t[0],s=(n&192)===0,r=(n&1)===0;if(s&&r)return et(t);throw new TypeError("Invalid WebP")}if(e==="VP8 "&&t[0]!==47)return tt(t);const a=E(t,3,6);if(e==="VP8L"&&a!=="9d012a")return it(t);throw new TypeError("Invalid WebP")}},B=new Map([["bmp",ni],["cur",pi],["dds",ci],["gif",di],["heif",gi],["icns",xi],["ico",Ee],["j2c",Fi],["jp2",bi],["jpg",Si],["ktx",Pi],["png",Mi],["pnm",zi],["psd",Hi],["svg",Gi],["tga",Yi],["tiff",Qi],["webp",at]]),nt=Array.from(B.keys()),st=new Map([[56,"psd"],[66,"bmp"],[68,"dds"],[71,"gif"],[73,"tiff"],[77,"tiff"],[82,"webp"],[105,"icns"],[137,"png"],[255,"jpg"]]);function rt(t){const e=t[0],a=st.get(e);return a&&B.get(a).validate(t)?a:nt.find(n=>B.get(n).validate(t))}const lt={disabledTypes:[]};function ot(t){const e=rt(t);if(typeof e<"u"){if(lt.disabledTypes.includes(e))throw new TypeError("disabled file type: "+e);const a=B.get(e).calculate(t);if(a!==void 0)return a.type=a.type??e,a}throw new TypeError("unsupported file type: "+e)}async function pt(t,e){try{const a=ot(t);if(!a.height||!a.width||!a.type)throw new g({...w,message:w.message(e)});const{width:n,height:s,type:r,orientation:o}=a,m=(o||0)>=5;return{width:m?s:n,height:m?n:s,format:r,orientation:o}}catch{throw new g({...w,message:w.message(e)})}}async function ct(t){const e=await fetch(t);if(!e.body||!e.ok)throw new g({...W,message:W.message(t)});const a=e.body.getReader();let n,s,r=new Uint8Array;for(;!n;){const o=await a.read();if(n=o.done,n)break;if(o.value){s=o.value;let m=new Uint8Array(r.length+s.length);m.set(r,0),m.set(s,r.length),r=m;try{const h=await pt(r,t);if(h)return await a.cancel(),h}catch{}}}throw new g({...w,message:w.message(t)})}async function ht(){if(!globalThis?.astroAsset?.imageService){const{default:t}=await ze(async()=>{const{default:e}=await import("./astro/assets-service.DeftQf-f.js").then(a=>a.s);return{default:e}},[]).catch(e=>{const a=new g(He);throw a.cause=e,a});return globalThis.astroAsset||(globalThis.astroAsset={}),globalThis.astroAsset.imageService=t,t}return globalThis.astroAsset.imageService}async function dt(t,e){if(!t||typeof t!="object")throw new g({...J,message:J.message(JSON.stringify(t))});if(typeof t.src>"u")throw new g({...X,message:X.message(t.src,"undefined",JSON.stringify(t))});if(Qe(t))throw new g(Le);const a=await ht(),n={...t,src:await ge(t.src)};if(t.inferSize&&Z(n.src)){const l=await ct(n.src);n.width??=l.width,n.height??=l.height,delete n.inferSize}const s=R(n.src)?n.src.fsPath:void 0,r=R(n.src)?n.src.clone??n.src:n.src;n.src=r;const o=a.validateOptions?await a.validateOptions(n,e):n,m=a.getSrcSet?await a.getSrcSet(o,e):[];let h=await a.getURL(o,e),y=await Promise.all(m.map(async l=>({transform:l.transform,url:await a.getURL(l.transform,e),descriptor:l.descriptor,attributes:l.attributes})));if(Re(a)&&globalThis.astroAsset.addStaticImage&&!(Z(o.src)&&h===o.src)){const l=a.propertiesToHash??Me;h=globalThis.astroAsset.addStaticImage(o,l,s),y=m.map(k=>({transform:k.transform,url:globalThis.astroAsset.addStaticImage(k.transform,l,s),descriptor:k.descriptor,attributes:k.attributes}))}return{rawOptions:n,options:o,src:h,srcSet:{values:y,attribute:y.map(l=>`${l.url} ${l.descriptor}`).join(", ")},attributes:a.getHTMLAttributes!==void 0?await a.getHTMLAttributes(o,e):{}}}const mt=fe("https://krooijers-sanquin.github.io"),$=ye(async(t,e,a)=>{const n=t.createAstro(mt,e,a);n.self=$;const s=n.props;if(s.alt===void 0||s.alt===null)throw new g(ue);typeof s.width=="string"&&(s.width=parseInt(s.width)),typeof s.height=="string"&&(s.height=parseInt(s.height));const r=await H(s),o={};return r.srcSet.values.length>0&&(o.srcset=r.srcSet.attribute),M`${we()}<img${A(r.src,"src")}${v(o)}${v(r.attributes)}>`},"/app/node_modules/astro/components/Image.astro",void 0),gt={"3g2":"video/3gpp2","3gp":"video/3gpp","3gpp":"video/3gpp","3mf":"model/3mf",aac:"audio/aac",ac:"application/pkix-attr-cert",adp:"audio/adpcm",adts:"audio/aac",ai:"application/postscript",aml:"application/automationml-aml+xml",amlx:"application/automationml-amlx+zip",amr:"audio/amr",apng:"image/apng",appcache:"text/cache-manifest",appinstaller:"application/appinstaller",appx:"application/appx",appxbundle:"application/appxbundle",asc:"application/pgp-keys",atom:"application/atom+xml",atomcat:"application/atomcat+xml",atomdeleted:"application/atomdeleted+xml",atomsvc:"application/atomsvc+xml",au:"audio/basic",avci:"image/avci",avcs:"image/avcs",avif:"image/avif",aw:"application/applixware",bdoc:"application/bdoc",bin:"application/octet-stream",bmp:"image/bmp",bpk:"application/octet-stream",btf:"image/prs.btif",btif:"image/prs.btif",buffer:"application/octet-stream",ccxml:"application/ccxml+xml",cdfx:"application/cdfx+xml",cdmia:"application/cdmi-capability",cdmic:"application/cdmi-container",cdmid:"application/cdmi-domain",cdmio:"application/cdmi-object",cdmiq:"application/cdmi-queue",cer:"application/pkix-cert",cgm:"image/cgm",cjs:"application/node",class:"application/java-vm",coffee:"text/coffeescript",conf:"text/plain",cpl:"application/cpl+xml",cpt:"application/mac-compactpro",crl:"application/pkix-crl",css:"text/css",csv:"text/csv",cu:"application/cu-seeme",cwl:"application/cwl",cww:"application/prs.cww",davmount:"application/davmount+xml",dbk:"application/docbook+xml",deb:"application/octet-stream",def:"text/plain",deploy:"application/octet-stream",dib:"image/bmp","disposition-notification":"message/disposition-notification",dist:"application/octet-stream",distz:"application/octet-stream",dll:"application/octet-stream",dmg:"application/octet-stream",dms:"application/octet-stream",doc:"application/msword",dot:"application/msword",dpx:"image/dpx",drle:"image/dicom-rle",dsc:"text/prs.lines.tag",dssc:"application/dssc+der",dtd:"application/xml-dtd",dump:"application/octet-stream",dwd:"application/atsc-dwd+xml",ear:"application/java-archive",ecma:"application/ecmascript",elc:"application/octet-stream",emf:"image/emf",eml:"message/rfc822",emma:"application/emma+xml",emotionml:"application/emotionml+xml",eps:"application/postscript",epub:"application/epub+zip",exe:"application/octet-stream",exi:"application/exi",exp:"application/express",exr:"image/aces",ez:"application/andrew-inset",fdf:"application/fdf",fdt:"application/fdt+xml",fits:"image/fits",g3:"image/g3fax",gbr:"application/rpki-ghostbusters",geojson:"application/geo+json",gif:"image/gif",glb:"model/gltf-binary",gltf:"model/gltf+json",gml:"application/gml+xml",gpx:"application/gpx+xml",gram:"application/srgs",grxml:"application/srgs+xml",gxf:"application/gxf",gz:"application/gzip",h261:"video/h261",h263:"video/h263",h264:"video/h264",heic:"image/heic",heics:"image/heic-sequence",heif:"image/heif",heifs:"image/heif-sequence",hej2:"image/hej2k",held:"application/atsc-held+xml",hjson:"application/hjson",hlp:"application/winhlp",hqx:"application/mac-binhex40",hsj2:"image/hsj2",htm:"text/html",html:"text/html",ics:"text/calendar",ief:"image/ief",ifb:"text/calendar",iges:"model/iges",igs:"model/iges",img:"application/octet-stream",in:"text/plain",ini:"text/plain",ink:"application/inkml+xml",inkml:"application/inkml+xml",ipfix:"application/ipfix",iso:"application/octet-stream",its:"application/its+xml",jade:"text/jade",jar:"application/java-archive",jhc:"image/jphc",jls:"image/jls",jp2:"image/jp2",jpe:"image/jpeg",jpeg:"image/jpeg",jpf:"image/jpx",jpg:"image/jpeg",jpg2:"image/jp2",jpgm:"image/jpm",jpgv:"video/jpeg",jph:"image/jph",jpm:"image/jpm",jpx:"image/jpx",js:"text/javascript",json:"application/json",json5:"application/json5",jsonld:"application/ld+json",jsonml:"application/jsonml+json",jsx:"text/jsx",jt:"model/jt",jxr:"image/jxr",jxra:"image/jxra",jxrs:"image/jxrs",jxs:"image/jxs",jxsc:"image/jxsc",jxsi:"image/jxsi",jxss:"image/jxss",kar:"audio/midi",ktx:"image/ktx",ktx2:"image/ktx2",less:"text/less",lgr:"application/lgr+xml",list:"text/plain",litcoffee:"text/coffeescript",log:"text/plain",lostxml:"application/lost+xml",lrf:"application/octet-stream",m1v:"video/mpeg",m21:"application/mp21",m2a:"audio/mpeg",m2v:"video/mpeg",m3a:"audio/mpeg",m4a:"audio/mp4",m4p:"application/mp4",m4s:"video/iso.segment",ma:"application/mathematica",mads:"application/mads+xml",maei:"application/mmt-aei+xml",man:"text/troff",manifest:"text/cache-manifest",map:"application/json",mar:"application/octet-stream",markdown:"text/markdown",mathml:"application/mathml+xml",mb:"application/mathematica",mbox:"application/mbox",md:"text/markdown",mdx:"text/mdx",me:"text/troff",mesh:"model/mesh",meta4:"application/metalink4+xml",metalink:"application/metalink+xml",mets:"application/mets+xml",mft:"application/rpki-manifest",mid:"audio/midi",midi:"audio/midi",mime:"message/rfc822",mj2:"video/mj2",mjp2:"video/mj2",mjs:"text/javascript",mml:"text/mathml",mods:"application/mods+xml",mov:"video/quicktime",mp2:"audio/mpeg",mp21:"application/mp21",mp2a:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mp4a:"audio/mp4",mp4s:"application/mp4",mp4v:"video/mp4",mpd:"application/dash+xml",mpe:"video/mpeg",mpeg:"video/mpeg",mpf:"application/media-policy-dataset+xml",mpg:"video/mpeg",mpg4:"video/mp4",mpga:"audio/mpeg",mpp:"application/dash-patch+xml",mrc:"application/marc",mrcx:"application/marcxml+xml",ms:"text/troff",mscml:"application/mediaservercontrol+xml",msh:"model/mesh",msi:"application/octet-stream",msix:"application/msix",msixbundle:"application/msixbundle",msm:"application/octet-stream",msp:"application/octet-stream",mtl:"model/mtl",musd:"application/mmt-usd+xml",mxf:"application/mxf",mxmf:"audio/mobile-xmf",mxml:"application/xv+xml",n3:"text/n3",nb:"application/mathematica",nq:"application/n-quads",nt:"application/n-triples",obj:"model/obj",oda:"application/oda",oga:"audio/ogg",ogg:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",omdoc:"application/omdoc+xml",onepkg:"application/onenote",onetmp:"application/onenote",onetoc:"application/onenote",onetoc2:"application/onenote",opf:"application/oebps-package+xml",opus:"audio/ogg",otf:"font/otf",owl:"application/rdf+xml",oxps:"application/oxps",p10:"application/pkcs10",p7c:"application/pkcs7-mime",p7m:"application/pkcs7-mime",p7s:"application/pkcs7-signature",p8:"application/pkcs8",pdf:"application/pdf",pfr:"application/font-tdpfr",pgp:"application/pgp-encrypted",pkg:"application/octet-stream",pki:"application/pkixcmp",pkipath:"application/pkix-pkipath",pls:"application/pls+xml",png:"image/png",prc:"model/prc",prf:"application/pics-rules",provx:"application/provenance+xml",ps:"application/postscript",pskcxml:"application/pskc+xml",pti:"image/prs.pti",qt:"video/quicktime",raml:"application/raml+yaml",rapd:"application/route-apd+xml",rdf:"application/rdf+xml",relo:"application/p2p-overlay+xml",rif:"application/reginfo+xml",rl:"application/resource-lists+xml",rld:"application/resource-lists-diff+xml",rmi:"audio/midi",rnc:"application/relax-ng-compact-syntax",rng:"application/xml",roa:"application/rpki-roa",roff:"text/troff",rq:"application/sparql-query",rs:"application/rls-services+xml",rsat:"application/atsc-rsat+xml",rsd:"application/rsd+xml",rsheet:"application/urc-ressheet+xml",rss:"application/rss+xml",rtf:"text/rtf",rtx:"text/richtext",rusd:"application/route-usd+xml",s3m:"audio/s3m",sbml:"application/sbml+xml",scq:"application/scvp-cv-request",scs:"application/scvp-cv-response",sdp:"application/sdp",senmlx:"application/senml+xml",sensmlx:"application/sensml+xml",ser:"application/java-serialized-object",setpay:"application/set-payment-initiation",setreg:"application/set-registration-initiation",sgi:"image/sgi",sgm:"text/sgml",sgml:"text/sgml",shex:"text/shex",shf:"application/shf+xml",shtml:"text/html",sieve:"application/sieve",sig:"application/pgp-signature",sil:"audio/silk",silo:"model/mesh",siv:"application/sieve",slim:"text/slim",slm:"text/slim",sls:"application/route-s-tsid+xml",smi:"application/smil+xml",smil:"application/smil+xml",snd:"audio/basic",so:"application/octet-stream",spdx:"text/spdx",spp:"application/scvp-vp-response",spq:"application/scvp-vp-request",spx:"audio/ogg",sql:"application/sql",sru:"application/sru+xml",srx:"application/sparql-results+xml",ssdl:"application/ssdl+xml",ssml:"application/ssml+xml",stk:"application/hyperstudio",stl:"model/stl",stpx:"model/step+xml",stpxz:"model/step-xml+zip",stpz:"model/step+zip",styl:"text/stylus",stylus:"text/stylus",svg:"image/svg+xml",svgz:"image/svg+xml",swidtag:"application/swid+xml",t:"text/troff",t38:"image/t38",td:"application/urc-targetdesc+xml",tei:"application/tei+xml",teicorpus:"application/tei+xml",text:"text/plain",tfi:"application/thraud+xml",tfx:"image/tiff-fx",tif:"image/tiff",tiff:"image/tiff",toml:"application/toml",tr:"text/troff",trig:"application/trig",ts:"video/mp2t",tsd:"application/timestamped-data",tsv:"text/tab-separated-values",ttc:"font/collection",ttf:"font/ttf",ttl:"text/turtle",ttml:"application/ttml+xml",txt:"text/plain",u3d:"model/u3d",u8dsn:"message/global-delivery-status",u8hdr:"message/global-headers",u8mdn:"message/global-disposition-notification",u8msg:"message/global",ubj:"application/ubjson",uri:"text/uri-list",uris:"text/uri-list",urls:"text/uri-list",vcard:"text/vcard",vrml:"model/vrml",vtt:"text/vtt",vxml:"application/voicexml+xml",war:"application/java-archive",wasm:"application/wasm",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webmanifest:"application/manifest+json",webp:"image/webp",wgsl:"text/wgsl",wgt:"application/widget",wif:"application/watcherinfo+xml",wmf:"image/wmf",woff:"font/woff",woff2:"font/woff2",wrl:"model/vrml",wsdl:"application/wsdl+xml",wspolicy:"application/wspolicy+xml",x3d:"model/x3d+xml",x3db:"model/x3d+fastinfoset",x3dbz:"model/x3d+binary",x3dv:"model/x3d-vrml",x3dvz:"model/x3d+vrml",x3dz:"model/x3d+xml",xaml:"application/xaml+xml",xav:"application/xcap-att+xml",xca:"application/xcap-caps+xml",xcs:"application/calendar+xml",xdf:"application/xcap-diff+xml",xdssc:"application/dssc+xml",xel:"application/xcap-el+xml",xenc:"application/xenc+xml",xer:"application/patch-ops-error+xml",xfdf:"application/xfdf",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xhvml:"application/xv+xml",xlf:"application/xliff+xml",xm:"audio/xm",xml:"text/xml",xns:"application/xcap-ns+xml",xop:"application/xop+xml",xpl:"application/xproc+xml",xsd:"application/xml",xsf:"application/prs.xsf+xml",xsl:"application/xml",xslt:"application/xml",xspf:"application/xspf+xml",xvm:"application/xv+xml",xvml:"application/xv+xml",yaml:"text/yaml",yang:"application/yang",yin:"application/yin+xml",yml:"text/yaml",zip:"application/zip"};function ut(t){let e=(""+t).trim().toLowerCase(),a=e.lastIndexOf(".");return gt[~a?e.substring(++a):e]}const kt=fe("https://krooijers-sanquin.github.io"),yt=ye(async(t,e,a)=>{const n=t.createAstro(kt,e,a);n.self=yt;const s=["webp"],r="png",o=["gif","svg","jpg","jpeg"],{formats:m=s,pictureAttributes:h={},fallbackFormat:y,...l}=n.props;if(l.alt===void 0||l.alt===null)throw new g(ue);const k=l.class?.match(/\bastro-\w{8}\b/)?.[0];k&&(h.class?h.class=`${h.class} ${k}`:h.class=k);for(const b in l)b.startsWith("data-astro-cid")&&(h[b]=l[b]);const C=await ge(l.src),_e=await Promise.all(m.map(async b=>await H({...l,src:C,format:b,widths:l.widths,densities:l.densities})));let O=y??r;!y&&R(C)&&o.includes(C.format)&&(O=C.format);const D=await H({...l,format:O,widths:l.widths,densities:l.densities}),q={},U={};return l.sizes&&(U.sizes=l.sizes),D.srcSet.values.length>0&&(q.srcset=D.srcSet.attribute),M`${we()}<picture${v(h)}> ${Object.entries(_e).map(([b,f])=>{const je=l.densities||!l.densities&&!l.widths?`${f.src}${f.srcSet.values.length>0?", "+f.srcSet.attribute:""}`:f.srcSet.attribute;return M`<source${A(je,"srcset")}${A(ut(f.options.format??f.src)??`image/${f.options.format}`,"type")}${v(U)}>`})} <img${A(D.src,"src")}${v(q)}${v(D.attributes)}> </picture>`},"/app/node_modules/astro/components/Picture.astro",void 0),ft={service:{entrypoint:"astro/assets/services/sharp",config:{}},domains:[],remotePatterns:[]},H=async t=>await dt(t,ft),xt={src:"/_astro/20250509_152002.Dj_pgHTA.png",width:1502,height:457,format:"png"},Ft={title:"You were building a DAG anyway",description:"Don't let your workflows live (and die) in your head",date:"2025-05-09T00:00:00.000Z",tags:["bioinformatics","data science","data engineering"],authors:["Koos Rooijers"]};function At(){return[{depth:2,slug:"part-1-the-soapbox",text:"Part 1: the soapbox"},{depth:3,slug:"but-what-are-the-benefits",text:"But, what are the benefits?"},{depth:3,slug:"but-is-it-worth-the-effort",text:"But, is it worth the effort?"},{depth:2,slug:"part-2-getting-it-done",text:"Part 2: getting it done"},{depth:3,slug:"tools-of-the-trade",text:"Tools of the trade"},{depth:3,slug:"what-they-didnt-tell-you",text:"What they didn’t tell you"},{depth:2,slug:"part-3-tips-and-tricks-for-snakemake",text:"Part 3: tips and tricks for snakemake"},{depth:3,slug:"show-me-your-dag",text:"Show me your DAG"},{depth:3,slug:"show-me-your-plans",text:"Show me your plans"},{depth:3,slug:"list-the-inputs",text:"List the inputs"},{depth:3,slug:"using-jupyter-notebooks",text:"Using jupyter notebooks"},{depth:3,slug:"using-containers",text:"Using containers"}]}const Ct=!0;function he(t){const e={a:"a",blockquote:"blockquote",button:"button",code:"code",em:"em",figure:"figure",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",section:"section",span:"span",style:"style",ul:"ul",...t.components};return i(me,{children:[i($,{src:xt,alt:"DAG of example workflow for experimental proteomics data"}),`
`,i(e.section,{class:"heading","data-heading-rank":"2","aria-labelledby":"part-1-the-soapbox",children:[i(e.h2,{id:"part-1-the-soapbox",children:"Part 1: the soapbox"}),`
`,i(e.p,{children:"As a researcher/data scientist, I notice that each project has a similar lifecycle:"}),`
`,i(e.ul,{children:[`
`,i(e.li,{children:"You get some raw data"}),`
`,i(e.li,{children:"You perform some processing on that raw data"}),`
`,i(e.li,{children:"You do some analyses on that processed data"}),`
`,i(e.li,{children:"You make some figures using those analyses"}),`
`,i(e.li,{children:"You write a manuscript using those figures and analyses outcomes"}),`
`]}),`
`,i(e.blockquote,{children:[`
`,i(e.p,{children:"it seems so simple! why does this stuff need to take years? :)"}),`
`]}),`
`,i(e.p,{children:`In practice, these “processing” and “analyses” steps can involve many different subtasks,
and use a lot of different software/tooling, and also involve interdependencies.`}),`
`,i(e.p,{children:`But underneath it all, there is an “implicit graph” connecting these dependencies:
output of one (or more) step(s) is used as input to the next step, and ultimately this all ends up in “publication-grade” figures.`}),`
`,i(e.p,{children:["Since we’re building that “directed, acyclic graph” (DAG) ",i(e.em,{children:"anyway"}),", so why not formalize it, and reap the benefits?"]}),`
`,i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"but-what-are-the-benefits",children:[i(e.h3,{id:"but-what-are-the-benefits",children:"But, what are the benefits?"}),`
`,i(e.ul,{children:[`
`,i(e.li,{children:"proper description of the workflow"}),`
`,i(e.li,{children:[`provenance
`,i(e.ul,{children:[`
`,i(e.li,{children:"the relationship between output files (e.g. figures, tables) and the inputs to them (either directly or transiently)"}),`
`]}),`
`]}),`
`,i(e.li,{children:[`cascading changes
`,i(e.ul,{children:[`
`,i(e.li,{children:"as a consequence of the above: understanding which (output, or intermediate) files need to be recreated due to changes in input or parameters"}),`
`]}),`
`]}),`
`,i(e.li,{children:"easily rerunning the workflow"}),`
`,i(e.li,{children:"reusability"}),`
`]}),`
`]}),i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"but-is-it-worth-the-effort",children:[i(e.h3,{id:"but-is-it-worth-the-effort",children:"But, is it worth the effort?"}),`
`,i(e.p,{children:"Well, maybe…"}),`
`,i(e.p,{children:`To be fair, I started doing this way too late.
I thought the cognitive load of remembering which file was generated using which script/notebook/shell command was tolerable.
I thought this was normal part of “my workload” and “my expertise”.`}),`
`,i(e.p,{children:["However, as projects grow and drag on, remembering how you made ",i(e.code,{children:"peptide_database.hdf5"}),", ",i(e.code,{children:"results.xlsx"})," or ",i(e.code,{children:"input_table.tsv"})," three years ago just becomes “not fun”."]}),`
`,i(e.p,{children:["Sure, you can write a ",i(e.code,{children:"README.md"})," or some notes you made in ",i(e.code,{children:"$internal_documentation_system"}),`, but that documentation might be out of date, missing some important details, etc.
And ultimately, all that serves as a description (albeit “informal”) of that DAG you are building, `,i(e.em,{children:"anyway"}),"."]}),`
`,i(e.p,{children:"It would be great if it were something “executable” and reproducible, and guaranteed to be correct."}),`
`,i(e.hr,{}),`
`]})]}),i(e.section,{class:"heading","data-heading-rank":"2","aria-labelledby":"part-2-getting-it-done",children:[i(e.h2,{id:"part-2-getting-it-done",children:"Part 2: getting it done"}),`
`,i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"tools-of-the-trade",children:[i(e.h3,{id:"tools-of-the-trade",children:"Tools of the trade"}),`
`,i(e.p,{children:"Unsurprisingly, the idea of describing a pipeline as a DAG is so common, that many different options exist."}),`
`,i(e.p,{children:"Personally, I won’t tell you to implement it one way or another, instead just describe the options I have considered and settled on."}),`
`,i(e.p,{children:["One of the earliest posts (!) of ",i(e.a,{href:"https://www.biostars.org/p/79/#81",rel:"nofollow noreferrer noopener",target:"_blank",children:"biostars"})," is one that I can appreciate: just use the unix tool that already is out there: ",i(e.code,{children:"make"}),"!"]}),`
`,i(e.p,{children:[i(e.code,{children:"make"}),` is software for “build automation”, indeed mapping and ordering dependencies,
commonly used for compilation of source code to executable programs.
During my PhD I did use `,i(e.code,{children:"make"}),` to setup pipelines.
However, I found ergonomics lacking (the syntax, tooling, introspection, documentation).`]}),`
`,i(e.p,{children:["In the years after, I’ve looked around for alternatives (and even built some, obviously and uncreatively called ",i(e.code,{children:"krmake"})," …)"]}),`
`,i(e.ul,{children:[`
`,i(e.li,{children:[`dvc
`,i(e.ul,{children:[`
`,i(e.li,{children:"seems to focus on ML"}),`
`]}),`
`]}),`
`,i(e.li,{children:[`airflow / windmill
`,i(e.ul,{children:[`
`,i(e.li,{children:"heavyweight"}),`
`]}),`
`]}),`
`,i(e.li,{children:[`snakemake
`,i(e.ul,{children:[`
`,i(e.li,{children:"this is the one?"}),`
`]}),`
`]}),`
`]}),`
`,i(e.p,{children:["For now, I’ve settled on ",i(e.a,{href:"https://snakemake.github.io/",rel:"nofollow noreferrer noopener",target:"_blank",children:"snakemake"}),"."]}),`
`,i(e.p,{children:`There are some sharp edges: the syntax is “mostly-python”,
and you can use python throughout the Snakemake file,
but sometimes you get bitten by the preprocessing which happens behind the scenes
(since it isn’t really python, rather it gets “pre-processed”).`}),`
`,i(e.p,{children:"The syntax is very much straightforward, mapping input(s) to output(s), using a script or command, which forms the “edge” in the graph:"}),`
`,i(e.figure,{"data-rehype-pretty-code-figure":"",children:i(e.pre,{style:{"--shiki-light":"#0e1116","--shiki-dark":"#f0f3f6","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#0a0c10"},tabindex:"0","data-language":"python","data-theme":"github-light-high-contrast github-dark-high-contrast",children:i(e.code,{"data-language":"python","data-theme":"github-light-high-contrast github-dark-high-contrast",style:{display:"grid"},children:[i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"SAMPLES"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" ="}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:" ["}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"what"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:", "}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"ever"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"]  "}),i(e.span,{style:{"--shiki-light":"#66707B","--shiki-dark":"#BDC4CC"},children:"# load sample metadata e.g. with `pandas`"})]}),`
`,i(e.span,{"data-line":"",children:" "}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"rule prepare_data:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"    input"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        infiles"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"expand("}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"data/raw/'}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"{sample}"}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'.tsv.gz"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:", "}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:"sample"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"SAMPLES"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"),"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        script"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"scripts/prepare_raw_data.py"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    output:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        samplesheet"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"protected("}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"output/data/samplesheet.tsv"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"),"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        measurements"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"protected("}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"output/data/measurements.h5"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"),"})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    shell:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:"        python {input.script} {input.infiles} -o {output.measurements} -m {output.samplesheet}"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        "})]}),`
`,i(e.span,{"data-line":"",children:" "}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"rule run_model:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"    input"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "output/data/samplesheet.tsv"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "output/data/measurements.h5"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        script"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"notebooks/scripts/run_model.ipynb"'})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    output:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        protected("}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"output/model-output/trace.h5"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"),"})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    shell:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:"        jupyter execute --inplace {input.script}"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),`
`,i(e.span,{"data-line":"",children:" "}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"rule plot_coef_pairplot:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"    input"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "data/pipeline/samplesheet.tsv"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "data/pipeline/intensity-values.tsv"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "data/pipeline/model-output/pergene_hdis.h5"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        metadata"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"data/pipeline/raw/hgnc_metadata.tsv.gz"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        script"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"notebooks/manuscripts/biology-rbps-in-activation/scripts/plot_model_coeff_correlations.ipynb"'})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    output:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "figures/pipeline/coef_pairplot.pdf"'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    shell:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:"        jupyter execute --inplace {input.script}"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),`
`,i(e.span,{"data-line":"",children:" "}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"rule plot_data_heatmaps:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"    input"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "data/pipeline/samplesheet.tsv"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "data/pipeline/intensity-values.tsv"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "data/pipeline/model-output/log_intensity_medians.tsv"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "data/pipeline/model-output/pergene_hdis.h5"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        metadata"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"data/pipeline/raw/hgnc_metadata.tsv.gz"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        script"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"notebooks/manuscripts/biology-rbps-in-activation/scripts/plot_clustered_heatmap_zscores.ipynb"'})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    output:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "figures/pipeline/zscaled-heatmap.pdf"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "figures/pipeline/log-intensity-heatmap.pdf"'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    shell:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:"        jupyter execute --inplace {input.script}"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),`
`,i(e.span,{"data-line":"",children:" "}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"rule fig_heatmap:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"    input"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:"        'figures/pipeline/zscaled-heatmap.pdf'"})}),`
`,i(e.span,{"data-line":"",children:" "}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"rule fig_coef_plot:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"    input"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:"        'figures/pipeline/coef_pairplot.pdf'"})}),`
`,i(e.span,{"data-line":"",children:" "}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#66707B","--shiki-dark":"#BDC4CC"},children:'# collect all figures in a meta "all" rule:'})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"rule "}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"all"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    default_target: "}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"True"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"    input"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        rules.fig_heatmap.input,"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        rules.fig_coef_plot.input,"})}),i(e.button,{type:"button",title:"Copy code","aria-label":"Copy code",data:`SAMPLES = ["what", "ever"]  # load sample metadata e.g. with \`pandas\`

rule prepare_data:
    input:
        infiles=expand("data/raw/{sample}.tsv.gz", sample=SAMPLES),
        script="scripts/prepare_raw_data.py",
    output:
        samplesheet=protected("output/data/samplesheet.tsv"),
        measurements=protected("output/data/measurements.h5"),
    shell:
        """
        python {input.script} {input.infiles} -o {output.measurements} -m {output.samplesheet}
        """        

rule run_model:
    input:
        "output/data/samplesheet.tsv",
        "output/data/measurements.h5",
        script="notebooks/scripts/run_model.ipynb"
    output:
        protected("output/model-output/trace.h5"),
    shell:
        """
        jupyter execute --inplace {input.script}
        """

rule plot_coef_pairplot:
    input:
        "data/pipeline/samplesheet.tsv",
        "data/pipeline/intensity-values.tsv",
        "data/pipeline/model-output/pergene_hdis.h5",
        metadata="data/pipeline/raw/hgnc_metadata.tsv.gz",
        script="notebooks/manuscripts/biology-rbps-in-activation/scripts/plot_model_coeff_correlations.ipynb"
    output:
        "figures/pipeline/coef_pairplot.pdf"
    shell:
        """
        jupyter execute --inplace {input.script}
        """

rule plot_data_heatmaps:
    input:
        "data/pipeline/samplesheet.tsv",
        "data/pipeline/intensity-values.tsv",
        "data/pipeline/model-output/log_intensity_medians.tsv",
        "data/pipeline/model-output/pergene_hdis.h5",
        metadata="data/pipeline/raw/hgnc_metadata.tsv.gz",
        script="notebooks/manuscripts/biology-rbps-in-activation/scripts/plot_clustered_heatmap_zscores.ipynb"
    output:
        "figures/pipeline/zscaled-heatmap.pdf",
        "figures/pipeline/log-intensity-heatmap.pdf"
    shell:
        """
        jupyter execute --inplace {input.script}
        """

rule fig_heatmap:
    input:
        'figures/pipeline/zscaled-heatmap.pdf'

rule fig_coef_plot:
    input:
        'figures/pipeline/coef_pairplot.pdf'

# collect all figures in a meta "all" rule:
rule all:
    default_target: True
    input:
        rules.fig_heatmap.input,
        rules.fig_coef_plot.input,`,class:"rehype-pretty-copy",onclick:"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add('rehype-pretty-copied');window.setTimeout(() => this.classList.remove('rehype-pretty-copied'), 1000);",children:[i(e.span,{class:"ready"}),i(e.span,{class:"success"})]}),i(e.style,{children:`:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}`})]})})}),`
`]}),i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"what-they-didnt-tell-you",children:[i(e.h3,{id:"what-they-didnt-tell-you",children:"What they didn’t tell you"}),`
`,i(e.p,{children:"Describing the steps in your pipeline is only a part of what’s necessary to create a truly reproducible pipeline."}),`
`,i(e.p,{children:[`Your processing steps will involve software, and thus there is a dependency between that software and the outcomes of your pipeline.
`,i(e.code,{children:"docker"}),` gives some reproducibility, as you can package software components into containers.
However, some things are hard or impossible to capture and to make reproducible, such as:`]}),`
`,i(e.ul,{children:[`
`,i(e.li,{children:"networking (using external resources that live on the internet, may change or disappear)"}),`
`,i(e.li,{children:"your machine (a different CPU, different kernel, or even GPU drivers)"}),`
`]}),`
`,i(e.p,{children:"The non-reproducibility might take form of:"}),`
`,i(e.ul,{children:[`
`,i(e.li,{children:"runtime errors that didn’t appear before"}),`
`,i(e.li,{children:"rounding errors"}),`
`,i(e.li,{children:"incomplete data, which can lead to silent errors (but wildly different results)"}),`
`]}),`
`,i(e.p,{children:"Here, I can only offer some advice, but there is no silver bullet."}),`
`,i(e.p,{children:`When it comes to external data dependencies, just “vendor it in”. This means, download what you need and treat it as a “raw data dependency” in your pipeline.
This makes that data a “leaf node” in your DAG.`}),`
`,i(e.p,{children:"If it’s just a matter of “download file from HTTP/FTP server”, then you might get away with a rule in snakemake that calls curl."}),`
`,i(e.p,{children:`I usually place such files in a “data/vendor/” subdirectory (as opposed to “data/raw/”) and add some notes (in a README.md) next to it.
There, I describe which URL I obtained the data from (and sometimes, where on the website I had to click to obtain it).`}),`
`,i(e.p,{children:`With software dependencies, I make judgement calls. I try to use reproducible environments, e.g. python virtual environments (managed by poetry).
When properly described with lockfiles, this pins all external dependencies and their versions.
However, sometimes external software involves archaic build steps which are not really amenable to virtual environments. In such cases, I try to wrap them into a lightweight container.
And to admit, sometimes, I just omit that part of reproducibility…`}),`
`,i(e.hr,{}),`
`]})]}),i(e.section,{class:"heading","data-heading-rank":"2","aria-labelledby":"part-3-tips-and-tricks-for-snakemake",children:[i(e.h2,{id:"part-3-tips-and-tricks-for-snakemake",children:"Part 3: tips and tricks for snakemake"}),`
`,i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"show-me-your-dag",children:[i(e.h3,{id:"show-me-your-dag",children:"Show me your DAG"}),`
`,i(e.figure,{"data-rehype-pretty-code-figure":"",children:i(e.pre,{style:{"--shiki-light":"#0e1116","--shiki-dark":"#f0f3f6","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#0a0c10"},tabindex:"0","data-language":"bash","data-theme":"github-light-high-contrast github-dark-high-contrast",children:i(e.code,{"data-language":"bash","data-theme":"github-light-high-contrast github-dark-high-contrast",style:{display:"grid"},children:[i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:"snakemake"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" --rulegraph"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" |"}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:" dot"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -Tpdf"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" >"}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:" snakemake_dag.pdf"})]}),i(e.button,{type:"button",title:"Copy code","aria-label":"Copy code",data:"snakemake --rulegraph | dot -Tpdf > snakemake_dag.pdf",class:"rehype-pretty-copy",onclick:"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add('rehype-pretty-copied');window.setTimeout(() => this.classList.remove('rehype-pretty-copied'), 1000);",children:[i(e.span,{class:"ready"}),i(e.span,{class:"success"})]}),i(e.style,{children:`:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}`})]})})}),`
`]}),i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"show-me-your-plans",children:[i(e.h3,{id:"show-me-your-plans",children:"Show me your plans"}),`
`,i(e.p,{children:"Useful when you have a larger pipeline. Get a table of jobs to run, their inputs and outputs, etc."}),`
`,i(e.p,{children:["(install ",i(e.a,{href:"https://www.visidata.org/",rel:"nofollow noreferrer noopener",target:"_blank",children:"visidata"})," and thank me later)"]}),`
`,i(e.figure,{"data-rehype-pretty-code-figure":"",children:i(e.pre,{style:{"--shiki-light":"#0e1116","--shiki-dark":"#f0f3f6","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#0a0c10"},tabindex:"0","data-language":"bash","data-theme":"github-light-high-contrast github-dark-high-contrast",children:i(e.code,{"data-language":"bash","data-theme":"github-light-high-contrast github-dark-high-contrast",style:{display:"grid"},children:[i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:"snakemake"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -D"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" |"}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:" vd"})]}),i(e.button,{type:"button",title:"Copy code","aria-label":"Copy code",data:"snakemake -D | vd",class:"rehype-pretty-copy",onclick:"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add('rehype-pretty-copied');window.setTimeout(() => this.classList.remove('rehype-pretty-copied'), 1000);",children:[i(e.span,{class:"ready"}),i(e.span,{class:"success"})]}),i(e.style,{children:`:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}`})]})})}),`
`]}),i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"list-the-inputs",children:[i(e.h3,{id:"list-the-inputs",children:"List the inputs"}),`
`,i(e.figure,{"data-rehype-pretty-code-figure":"",children:i(e.pre,{style:{"--shiki-light":"#0e1116","--shiki-dark":"#f0f3f6","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#0a0c10"},tabindex:"0","data-language":"bash","data-theme":"github-light-high-contrast github-dark-high-contrast",children:i(e.code,{"data-language":"bash","data-theme":"github-light-high-contrast github-dark-high-contrast",style:{display:"grid"},children:[i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:"snakemake"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -q"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -n"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -D"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -f"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" |"}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:" awk"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -F"}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"\\t"'}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:" '{print($5)}'"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" |"}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:" tail"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -n+2"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" |"}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:" awk"}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:" 'length($0) > 1'"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" |"}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:" tr"}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:" ,"}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:" '\\n'"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" |"}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:" sort"}),i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:" -V"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:" |"}),i(e.span,{style:{"--shiki-light":"#702C00","--shiki-dark":"#FFB757"},children:" uniq"})]}),i(e.button,{type:"button",title:"Copy code","aria-label":"Copy code",data:`snakemake -q -n -D -f | awk -F"\\t" '{print($5)}' | tail -n+2 | awk 'length($0) > 1' | tr , '\\n' | sort -V | uniq`,class:"rehype-pretty-copy",onclick:"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add('rehype-pretty-copied');window.setTimeout(() => this.classList.remove('rehype-pretty-copied'), 1000);",children:[i(e.span,{class:"ready"}),i(e.span,{class:"success"})]}),i(e.style,{children:`:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}`})]})})}),`
`]}),i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"using-jupyter-notebooks",children:[i(e.h3,{id:"using-jupyter-notebooks",children:"Using jupyter notebooks"}),`
`,i(e.p,{children:["In a ",i(e.code,{children:"Snakemake"})," file:"]}),`
`,i(e.figure,{"data-rehype-pretty-code-figure":"",children:i(e.pre,{style:{"--shiki-light":"#0e1116","--shiki-dark":"#f0f3f6","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#0a0c10"},tabindex:"0","data-language":"python","data-theme":"github-light-high-contrast github-dark-high-contrast",children:i(e.code,{"data-language":"python","data-theme":"github-light-high-contrast github-dark-high-contrast",style:{display:"grid"},children:[i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"rule run_model:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#023B95","--shiki-dark":"#91CBFF"},children:"    input"}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:":"})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "output/data/samplesheet.tsv"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        "output/data/measurements.h5"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:","})]}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        script"}),i(e.span,{style:{"--shiki-light":"#A0111F","--shiki-dark":"#FF9492"},children:"="}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"notebooks/scripts/run_model.ipynb"'})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    output:"})}),`
`,i(e.span,{"data-line":"",children:[i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"        protected("}),i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'"output/model-output/trace.h5"'}),i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"),"})]}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#0E1116","--shiki-dark":"#F0F3F6"},children:"    shell:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:"        jupyter execute --inplace {input.script}"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{style:{"--shiki-light":"#032563","--shiki-dark":"#ADDCFF"},children:'        """'})}),i(e.button,{type:"button",title:"Copy code","aria-label":"Copy code",data:`rule run_model:
    input:
        "output/data/samplesheet.tsv",
        "output/data/measurements.h5",
        script="notebooks/scripts/run_model.ipynb"
    output:
        protected("output/model-output/trace.h5"),
    shell:
        """
        jupyter execute --inplace {input.script}
        """`,class:"rehype-pretty-copy",onclick:"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add('rehype-pretty-copied');window.setTimeout(() => this.classList.remove('rehype-pretty-copied'), 1000);",children:[i(e.span,{class:"ready"}),i(e.span,{class:"success"})]}),i(e.style,{children:`:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}`})]})})}),`
`,i(e.p,{children:"This will execute the notebook and (re)write the results / figures, in the notebook file."}),`
`,i(e.p,{children:["Note that it is not possible to pass arguments to the ",i(e.code,{children:"jupyter execute"}),` command; therefore it’s hard to use notebooks as generic “data processing” scripts.
But for many academic purposes, that doesn’t matter, as the notebooks are heavily tailored.
If you really want to pass dynamic arguments to the notebook, you might be able to do something with environment variables / `,i(e.code,{children:".env"})," files."]}),`
`,i(e.p,{children:"If you have a notebook which is generic and you want to run it on multiple input files, I recommend just refactoring the notebook into a proper python script."}),`
`]}),i(e.section,{class:"heading","data-heading-rank":"3","aria-labelledby":"using-containers",children:[i(e.h3,{id:"using-containers",children:"Using containers"}),`
`,i(e.p,{children:"Using rmarkdown / R in a docker container, in a Snakemake step:"}),`
`,i(e.figure,{"data-rehype-pretty-code-figure":"",children:i(e.pre,{style:{"--shiki-light":"#0e1116","--shiki-dark":"#f0f3f6","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#0a0c10"},tabindex:"0","data-language":"Snakemake","data-theme":"github-light-high-contrast github-dark-high-contrast",children:i(e.code,{"data-language":"Snakemake","data-theme":"github-light-high-contrast github-dark-high-contrast",style:{display:"grid"},children:[i(e.span,{"data-line":"",children:i(e.span,{children:"rule r_limma:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"    input:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:'        "datafile"'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"    output:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:'        "figures/plot.pdf"'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"    shell:"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"        # fun stuff, R in docker with R libraries in a docker volume ..."})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:'        """'})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"        docker run \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            --rm -it \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            -v `pwd`/data/:/app/data/:ro \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            -v `pwd`/scripts/pipeline/:/scripts/:ro \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            -v `pwd`/data/pipeline/rstudio/:/output/ \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            -v `pwd`/figures/pipeline/:/figures/ \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            -v r_container_r_libs:/home/rstudio/lib \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            -e R_LIBS=/home/rstudio/lib/:/usr/local/lib/R/site-library:/usr/local/lib/R/library \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            --name 'rstudio_tmp_snakemake_limma' \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            --entrypoint /bin/bash \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:"            rocker/verse:4.3 \\"})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:`            -c "Rscript -e 'rmarkdown::render(\\\\"/scripts/run_limma.Rmd\\\\", output_dir=\\\\"/figures/\\\\", intermediates_dir=\\\\"/tmp/\\\\")'"`})}),`
`,i(e.span,{"data-line":"",children:i(e.span,{children:'        """'})}),i(e.button,{type:"button",title:"Copy code","aria-label":"Copy code",data:`rule r_limma:
    input:
        "datafile"
    output:
        "figures/plot.pdf"
    shell:
        # fun stuff, R in docker with R libraries in a docker volume ...
        """
        docker run \\
            --rm -it \\
            -v \`pwd\`/data/:/app/data/:ro \\
            -v \`pwd\`/scripts/pipeline/:/scripts/:ro \\
            -v \`pwd\`/data/pipeline/rstudio/:/output/ \\
            -v \`pwd\`/figures/pipeline/:/figures/ \\
            -v r_container_r_libs:/home/rstudio/lib \\
            -e R_LIBS=/home/rstudio/lib/:/usr/local/lib/R/site-library:/usr/local/lib/R/library \\
            --name 'rstudio_tmp_snakemake_limma' \\
            --entrypoint /bin/bash \\
            rocker/verse:4.3 \\
            -c "Rscript -e 'rmarkdown::render(\\\\"/scripts/run_limma.Rmd\\\\", output_dir=\\\\"/figures/\\\\", intermediates_dir=\\\\"/tmp/\\\\")'"
        """`,class:"rehype-pretty-copy",onclick:"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add('rehype-pretty-copied');window.setTimeout(() => this.classList.remove('rehype-pretty-copied'), 1000);",children:[i(e.span,{class:"ready"}),i(e.span,{class:"success"})]}),i(e.style,{children:`:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}pre button.rehype-pretty-copy { opacity: 0; }figure[data-rehype-pretty-code-figure]:hover > pre > code button.rehype-pretty-copy {opacity: 1;}`})]})})})]})]})]})}function bt(t={}){const{wrapper:e}=t.components||{};return e?i(e,{...t,children:i(he,{...t})}):he(t)}const Dt="src/content/blog/you-were-building-a-dag-anyway.mdx",_t="/app/src/content/blog/you-were-building-a-dag-anyway.mdx",N=(t={})=>bt({...t,components:{Fragment:me,...t.components,"astro-image":t.components?.img??$}});N[Symbol.for("mdx-component")]=!0;N[Symbol.for("astro.needsHeadRendering")]=!Ft.layout;N.moduleId="/app/src/content/blog/you-were-building-a-dag-anyway.mdx";export{N as Content,Ct as __usesAstroImage,N as default,_t as file,Ft as frontmatter,At as getHeadings,Dt as url};
